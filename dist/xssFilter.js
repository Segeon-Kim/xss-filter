/*
 * xssFilter 0.1.0
 * https://github.com/superRaytin/xssFilter
 *
 * Copyright 2014, SuperRaytin
 * Released under the MIT license.
 */

!function(a){function g(a){f.isObject(a)&&f.extend(this.config,a)}var b=/<style[^>]*>[^<]*<\/style>/gim,c=/<script[^>]*>[^<]*<\/script>/gim,d=/([\w-]+)\s*=\s*("([^"]*)"|'([^']*)'|([^ ]*))/gim,e=/<[a-zA-Z]+((\s+([\w-]+)\s*=\s*("([^"]*)"|'([^']*)'|([^ ]*)))+)>/gim,f={each:function(a,b){var c=a.length;if(c)for(var d=0;c>d&&b.call(a[d],a[d],d)!==!1;d++);else if("undefined"==typeof c)for(var e in a)if(b.call(a[e],a[e],e)===!1)break},str_trim:function(a){return a.replace(/^\s+/g,"").replace(/\s+$/g,"")},arr_compact:function(a){var b=[];return f.each(a,function(a){""!=f.str_trim(a)&&b.push(a)}),b},isObject:function(a){return a===Object(a)},extend:function(a,b){f.each(b,function(b,c){a[c]=b})}};g.prototype.config={label_style:!0,label_script:!0,beautifyTags:!0,escape:!1,blackList_attrs:{onclick:!0,ondblclick:!0,onchange:!0,onblur:!0,onfocus:!0,onkeydown:!0,onkeypress:!0,onkeyup:!0,onmousedown:!0,onmousemove:!0,onmouseover:!0,onmouseout:!0,onmouseup:!0,onselect:!0,onsubmit:!0,onreset:!0,onload:!0,onabort:!0}},g.prototype.options=function(a,b){var c=arguments,d=this.config;if(c.length)if("string"==typeof a){if("undefined"==typeof d[a])throw new Error(a+" is not a valid configuration name.");if("undefined"==typeof b)throw new Error("Please enter a value corresponding to the "+a);f.isObject(b)?f.extend(d[a],b):d[a]=b}else f.isObject(a)&&(b=a,f.extend(d,b))};var h=function(a,b){var c=a,g=a;return function(){var a=e.exec(g);if(e.lastIndex=0,a){var h=a[1],i=h.match(d);g=g.replace(h,""),f.each(i,function(a){var d=f.str_trim(a.substr(0,a.indexOf("=")));b.blackList_attrs[d]&&(c=c.replace(a,""))}),arguments.callee()}}(),c},i=function(a){return a.replace(b,"")},j=function(a){return a.replace(c,"")},k=function(a){return a.replace(/\t+\n/g,"").replace(/\s*>/gm,function(a){return a.replace(/\s+/,"")})},l=function(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;")};g.prototype.filter=function(a){if(""!=a){var b=a,c=this.config;return c.label_style&&(b=i(b)),c.label_script&&(b=j(b)),b=h(b,c),c.beautifyTags&&(b=k(b)),c.escape&&(b=l(b)),b}},"function"==typeof define&&(define.amd||define.cmd)?define(function(){return g}):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=g:a.xssFilter=g}(this);